---
import { getEntry, render } from "astro:content";

import StructuredData from "@/components/StructuredData.astro";
import { SITE } from "@/consts";
import BasicLayout from "@/layouts/BasicLayout.astro";
import { buildOrganizationSchema, buildWebPageSchema } from "@/lib/seo";

const entry = await getEntry("legal", "terms");
if (!entry) throw new Error("Terms of service not found");

const { data } = entry;
const { Content } = await render(entry);

const orgSchema = buildOrganizationSchema();
const pageSchema = buildWebPageSchema({
  title: data.title,
  description: data.seo.metaDescription,
  url: `${SITE.domain}/terms`,
  breadcrumbs: [
    { name: "Home", url: SITE.domain },
    { name: data.title, url: `${SITE.domain}/terms` },
  ],
});
---

<BasicLayout
  title={data.seo.metaTitle}
  description={data.seo.metaDescription}
>
  <StructuredData slot="head" data={orgSchema} />
  <StructuredData slot="head" data={pageSchema} />
  <Content />
</BasicLayout>
