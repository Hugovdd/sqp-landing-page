---
import { getEntry } from "astro:content";

import { CTASection } from "@/components/blocks/cta-section";
import { FAQ } from "@/components/blocks/faq";
import { Features } from "@/components/blocks/features";
import { ProductHero } from "@/components/blocks/product-hero";
import { TechStack } from "@/components/blocks/tech-stack";
import { Background } from "@/components/background";
import AnimateOnScroll from "@/components/AnimateOnScroll.astro";
import StructuredData from "@/components/StructuredData.astro";
import DefaultLayout from "@/layouts/DefaultLayout.astro";
import {
  buildFAQSchema,
  buildOrganizationSchema,
  buildProductSchema,
} from "@/lib/seo";

const product = await getEntry("products", "find-and-replace-fonts");
if (!product) throw new Error("Product not found");

const { data } = product;
const productSchema = buildProductSchema(data);
const faqSchema = buildFAQSchema(data.faqs);
const orgSchema = buildOrganizationSchema();
---

<DefaultLayout
  title={data.seo.metaTitle}
  description={data.seo.metaDescription}
  ogImage={data.seo.ogImage}
  keywords={data.seo.keywords}
>
  <StructuredData slot="head" data={orgSchema} />
  <StructuredData slot="head" data={productSchema} />
  {faqSchema && <StructuredData slot="head" data={faqSchema} />}

  <Background className="via-muted to-muted/80">
    <ProductHero
      client:load
      title={data.title}
      tagline={data.tagline}
      price={data.price}
      currency={data.currency}
      version={data.version}
      status={data.status}
      supportedApp={data.supportedApp}
      extensionType={data.extensionType}
      checkoutUrl={data.checkoutUrl}
      heroVideo={data.heroVideo}
      heroVideoShowControls={false}
      heroImage={data.heroImage}
      heroFeatures={data.heroFeatures}
      stats={data.stats}
      showDivider={false}
      mediaStyle="card"
    />
  </Background>

  <AnimateOnScroll animation="fade-up">
    <Features
      features={data.features}
      heading="Powerful Features"
      description="Everything you need to manage fonts in After Effects."
    />
  </AnimateOnScroll>

  <AnimateOnScroll animation="fade-up">
    <TechStack items={data.techStack} heading="Built with" />
  </AnimateOnScroll>

  <FAQ client:only="react" items={data.faqs} />

  <AnimateOnScroll animation="fade-up">
    <CTASection
      title={data.title}
      tagline={data.tagline}
      heading="The best-selling font tool for After Effects"
      description="Over 740 motion designers rely on Find and Replace Fonts to swap fonts across their projects in seconds."
      price={data.price}
      currency={data.currency}
      status={data.status}
      checkoutUrl={data.checkoutUrl}
      stats={data.stats}
    />
  </AnimateOnScroll>
</DefaultLayout>
