---
import { Background } from "@/components/background";
import { ContactForm } from "@/components/blocks/contact-form";
import StructuredData from "@/components/StructuredData.astro";
import { SITE } from "@/consts";
import DefaultLayout from "@/layouts/DefaultLayout.astro";
import { buildOrganizationSchema } from "@/lib/seo";

const orgSchema = buildOrganizationSchema();

// Turnstile site key â€” will be empty in dev, set via env in production
const turnstileSiteKey = import.meta.env.PUBLIC_TURNSTILE_SITE_KEY || "";
---

<DefaultLayout
  title="Contact"
  description={`Get in touch with ${SITE.name}. We'd love to hear from you.`}
>
  <StructuredData slot="head" data={orgSchema} />

  {/* Load Turnstile script if site key is available */}
  {turnstileSiteKey && (
    <script
      slot="head"
      src="https://challenges.cloudflare.com/turnstile/v0/api.js"
      async
      defer
    />
  )}

  <Background>
    <section class="py-28 lg:py-32 lg:pt-44">
      <div class="container max-w-2xl">
        <h1 class="text-center text-2xl font-semibold tracking-tight md:text-4xl lg:text-5xl">
          Contact us
        </h1>
        <p class="text-muted-foreground mt-4 text-center leading-snug lg:mx-auto">
          Have a question, feature request, or just want to say hi?
        </p>

        <div class="mt-10 md:mt-14 lg:mt-20">
          <ContactForm
            client:load
            turnstileSiteKey={turnstileSiteKey}
          />
        </div>

      </div>
    </section>
  </Background>
</DefaultLayout>
