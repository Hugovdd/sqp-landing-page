---
import { Background } from "@/components/background";
import { Button } from "@/components/ui/button";
import BasicLayout from "@/layouts/BasicLayout.astro";

const url = new URL(Astro.request.url);
const reason = url.searchParams.get("reason") || "unknown";

const messages: Record<string, string> = {
  invalid_hash: "The confirmation link is invalid or has expired.",
  already_subscribed: "This email is already subscribed.",
  server_error: "Something went wrong on our end. Please try again later.",
  unknown: "Something went wrong. Please try again.",
};

const message = messages[reason] || messages.unknown;
---

<BasicLayout
  title="Subscription Error"
  description="There was an error with your email subscription."
  noIndex={true}
>
  <Background>
    <div class="container flex min-h-[60vh] flex-col items-center justify-center py-28 text-center lg:min-h-[70vh]">
      <div class="max-w-md">
        <h1 class="text-2xl font-semibold tracking-tight md:text-3xl">
          Something went wrong
        </h1>
        <p class="text-muted-foreground mt-4 leading-relaxed">
          {message}
        </p>
        <div class="mt-8 flex flex-col items-center gap-4 sm:flex-row sm:justify-center">
          <a href="/">
            <Button>Back to Home</Button>
          </a>
          <a href="/contact">
            <Button variant="outline">Contact Support</Button>
          </a>
        </div>
      </div>
    </div>
  </Background>
</BasicLayout>
